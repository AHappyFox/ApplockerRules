function New-AppLockerHashRule {
    param (
        [Parameter(Mandatory=$True)]
        [string] $FilePath
    )

$GUID = (New-GUID).GUID
$FilePathTrimmed = $FilePath -replace "`"|'"
$HashInfo = (Get-AppLockerFileInformation -Path $FilePathTrimmed).Hash
$Algorithm, $FileHash = $HashInfo -split '\s+', 2
$FileLength = (Get-Item -Path $FilePathTrimmed).Length
$FileName = Split-Path -Path $FilePathTrimmed -Leaf
    
Write-Host "<FileHashRule Id=`"$GUID`" Name=`"$FileName`" Description=`"Test Description`" UserOrGroupSid=`"S-1-1-0`" Action=`"Allow`">"
Write-Host "    <Conditions>"
Write-Host "        <FileHashCondition>"
Write-Host "            <FileHash Type=`"$Algorithm`" Data=`"$FileHash`" SourceFileName=`"$FileName`" SourceFileLength=`"$FileLength`" />"
Write-Host "        </FileHashCondition>"
Write-Host "    </Conditions>"
Write-Host "</FileHashRule>"
}
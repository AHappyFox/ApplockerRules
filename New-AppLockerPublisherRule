function New-AppLockerPublisherRule {
    param (
        [Parameter(Mandatory=$True)]
        [string] $FilePath
    )

$GUID = (New-GUID).GUID
$FilePathTrimmed = $FilePath -replace "`"|'"
$Publisher = (Get-AppLockerFileInformation -Path $FilePathTrimmed).Publisher
$TrimmedPublisher = $Publisher -replace '\\.*$',''

Write-Host "<FilePublisherRule Id=`"$GUID`" Name=`"Signed by $TrimmedPublisher`" Description=`"Test Description`" UserOrGroupSid=`"S-1-1-0`" Action=`"Allow`">"
Write-Host "  <Conditions>"
Write-Host "      <FilePublisherCondition PublisherName=`"$TrimmedPublisher`" ProductName=`"*`" BinaryName=`"*`">"
Write-Host "          <BinaryVersionRange LowSection=`"*`" HighSection=`"*`" />"
Write-Host "      </FilePublisherCondition>"
Write-Host "  </Conditions>"
Write-Host "</FilePublisherRule>"
}